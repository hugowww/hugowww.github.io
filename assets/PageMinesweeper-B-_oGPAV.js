var v=Object.defineProperty;var M=(r,e,t)=>e in r?v(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var c=(r,e,t)=>M(r,typeof e!="symbol"?e+"":e,t);import{e as b,f as p,o as l,c as h,a as _,F as g,g as m,n as w,h as C,d as u,t as y,i as F,_ as R,b as x}from"./index-C4bxKiOZ.js";class k{constructor(e){c(this,"_engine");this._engine=e}get board(){return this._engine.board}revealCell(e,t){console.log(`Revealing cell at (${e}, ${t})`),this._engine.revealCell(e,t)}toggleFlag(e,t){console.log(`Toggling flag at (${e}, ${t})`),this._engine.toggleFlag(e,t)}}class E{constructor(e,t,i){this.width=e,this.height=t,this.mines=i}generate(){const e=this.createEmptyCells();return this.placeMines(e),this.calculateNeighbors(e),{width:this.width,height:this.height,mines:this.mines,cells:e,gameOver:!1,won:!1}}createEmptyCells(){return Array(this.height).fill(null).map((e,t)=>Array(this.width).fill(null).map((i,n)=>({x:n,y:t,isMine:!1,isRevealed:!1,isFlagged:!1,neighborMines:0})))}placeMines(e){this.getRandomMinePositions().forEach(({x:i,y:n})=>{e[n][i].isMine=!0})}calculateNeighbors(e){e.forEach((t,i)=>{t.forEach((n,o)=>{n.neighborMines=this.countNeighborMines(e,o,i)})})}getRandomMinePositions(){const e=[];for(;e.length<this.mines;){const t=Math.floor(Math.random()*this.width),i=Math.floor(Math.random()*this.height);e.some(n=>n.x===t&&n.y===i)||e.push({x:t,y:i})}return e}countNeighborMines(e,t,i){let n=0;for(let o=-1;o<=1;o++)for(let a=-1;a<=1;a++){const d=i+o,s=t+a;d>=0&&d<this.height&&s>=0&&s<this.width&&e[d][s].isMine&&n++}return n}}class N{constructor(e){this.board=e}revealCell(e,t){const i=this.board.cells[t][e];if(!(i.isFlagged||i.isRevealed)){if(i.isRevealed=!0,i.isMine){this.board.gameOver=!0;return}i.neighborMines===0&&this.revealNeighbors(e,t),this.checkWinCondition()}}toggleFlag(e,t){const i=this.board.cells[t][e];i.isRevealed||(i.isFlagged=!i.isFlagged)}revealNeighbors(e,t){for(let i=-1;i<=1;i++)for(let n=-1;n<=1;n++){const o=t+i,a=e+n;o>=0&&o<this.board.height&&a>=0&&a<this.board.width&&!this.board.cells[o][a].isRevealed&&this.revealCell(a,o)}}checkWinCondition(){this.board.won=this.board.cells.every(e=>e.every(t=>t.isMine?!t.isRevealed:t.isRevealed))}}const $={EASY:{width:9,height:9,mines:10},MEDIUM:{width:16,height:16,mines:40},HARD:{width:30,height:16,mines:99}};class B{constructor(e){c(this,"_board");c(this,"_interaction");const{width:t,height:i,mines:n}=$[e],o=new E(t,i,n);this._board=o.generate(),this._interaction=new N(this._board)}get board(){return this._board}revealCell(e,t){this._interaction.revealCell(e,t)}toggleFlag(e,t){this._interaction.toggleFlag(e,t)}}const D={class:"minesweeper-board"},I=["onClick","onContextmenu"],A=b({__name:"Board",setup(r){const e=new k(new B("MEDIUM")),t=p(e.board),i=(o,a)=>{e.revealCell(o,a),t.value={...e.board}},n=(o,a,d)=>{d.preventDefault(),e.toggleFlag(o,a),t.value={...e.board}};return(o,a)=>(l(),h("div",D,[_("table",null,[_("tbody",null,[(l(!0),h(g,null,m(t.value.cells,d=>(l(),h("tr",{key:d[0].y},[(l(!0),h(g,null,m(d,s=>(l(),h("td",{key:`${s.x}-${s.y}`,class:w({revealed:s.isRevealed,mine:s.isMine&&s.isRevealed,flagged:s.isFlagged}),onClick:f=>i(s.x,s.y),onContextmenu:C(f=>n(s.x,s.y,f),["prevent"])},[s.isRevealed&&!s.isMine?(l(),h(g,{key:0},[u(y(s.neighborMines>0?s.neighborMines:""),1)],64)):s.isRevealed&&s.isMine?(l(),h(g,{key:1},[u(" ðŸ’£ ")],64)):s.isFlagged?(l(),h(g,{key:2},[u(" ðŸš© ")],64)):F("",!0)],42,I))),128))]))),128))])])]))}}),L=R(A,[["__scopeId","data-v-837c9c49"]]),V={class:"text-center"},U=b({__name:"PageMinesweeper",setup(r){return(e,t)=>(l(),h("div",V,[t[0]||(t[0]=_("h1",null,"è¸©åœ°é›·",-1)),x(L)]))}});export{U as default};
